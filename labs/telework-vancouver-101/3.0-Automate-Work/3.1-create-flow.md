---
id: create-workflow
title: "3.1 Criar o Fluxo"
hide_table_of_contents: true
draft: false
---

## Visão Geral

Um fluxo representa uma sequência de etapas que são automatizadas para alcançar um resultado específico de negócios. Cada fluxo pode incluir esses componentes:
- **Gatilho**: O evento ou condição que, quando atendido, inicia automaticamente um fluxo.
- **Condições**: Permite fornecer condições sob as quais o fluxo será executado. Por exemplo, execute o fluxo apenas se um campo estiver acima de um determinado valor.
- **Ações**: As tarefas realizadas pelo Fluxo, como atualizar dados, solicitar aprovações ou enviar notificações.

## Objetivo: Fluxo de Aprovação de Solicitação de Teletrabalho
O objetivo aqui é criar um fluxo que automatize o processo de aprovação de solicitações de teletrabalho.

## Visão Geral do Fluxo
- O fluxo deve começar assim que uma nova solicitação de teletrabalho for criada.
- A primeira coisa que o fluxo precisa fazer é entrar em contato com o gerente da pessoa que está pedindo para trabalhar de casa, solicitando sua aprovação.
- Uma vez que temos a aprovação do gerente, o fluxo segue para duas etapas críticas.
- Primeiro, gera automaticamente um chamado para o nosso departamento de TI para configurar o acesso VPN para o funcionário.
- Em seguida, precisamos notificar por e-mail o funcionário que solicitou trabalhar de casa, informando que sua solicitação foi aprovada.

## Visão Geral da Configuração do Fluxo

**Gatilho:**
- O fluxo começa quando um novo registro de Caso de Teletrabalho é criado.

**Processo:**

1. **Solicitação de Aprovação:**
   - Enviar automaticamente uma solicitação de aprovação para o gerente do usuário que enviou o Caso de Teletrabalho.

2. **Após a Aprovação do Gerente:**
   - **Criação de Chamado de TI:**
     - Gerar um chamado para o departamento de TI configurar o acesso remoto VPN para o solicitante.
   - **Notificação de Aprovação:**
     - Enviar um e-mail ao solicitante informando que sua solicitação de teletrabalho foi aprovada.

## Resultado Final
Seu fluxo se parecerá com isto:
![](../images/2023-11-03-16-45-01.png)

:::caution
* Seu trabalho com o Fluxo existe apenas no seu navegador até você clicar no botão <span className="button-purple">Salvar</span>.
* É recomendável clicar no botão <span className="button-purple">Salvar</span> com frequência para garantir que você não perca nenhum progresso.
![](../images/2023-11-03-16-46-06.png)
:::

## Instruções

1. Na aba Inicial do App, na seção "Lógica e automação", **clique em Adicionar**.
![](../images/2023-10-04-14-59-29.png)

2. Clique em **Fluxo**.
![](../images/2023-10-04-15-01-41.png)

3. Clique em **Construir do zero** para criar um novo fluxo.
![](../images/2023-11-04-09-38-32.png)

4. Crie o fluxo com as seguintes informações:

    |**Campo** | **Valor** |
    |-|-|
    |**Nome** | Aprovação de Caso de Teletrabalho |
    |**Descrição** | Aprovar e atender novos Casos de Teletrabalho.

    ![](../images/2023-11-03-15-12-33.png)

    Clique no botão <span className="button-purple">Continuar</span>.

5. **Clique** no botão **Editar este fluxo** para iniciar o processo de configuração.
    ![](../images/2023-11-03-15-13-03.png)

6. Você pode ver um popup de tour. Vamos pular o tour por enquanto, clicando no botão **Pular tour**.

7. **Adicione um gatilho para determinar quando e como o Fluxo será executado.**
    1. Clique em **Adicionar um gatilho** no canto superior esquerdo da tela do designer de fluxo.
    ![](../images/2023-11-03-15-13-44.png)
    2. Selecione **Criado** na seção Registro.
    ![](../images/2023-11-03-15-14-42.png)
    3. Clique na lista suspensa 'Tabela'.
    ![](../images/2023-10-04-15-24-53.png)
    4. Digite `caso de teletrabalho` e clique na tabela **Caso de Teletrabalho**.
    ![](../images/2023-11-03-15-16-06.png)
    5. Clique em <span className="button-purple">Concluído</span> para fechar o gatilho.

8. **Solicite uma aprovação do gerente do usuário 'Aberto por' com a Ação 'Solicitar Aprovação'.**
    1. Clique em **Adicionar uma Ação, Lógica de Fluxo ou Subfluxo**.
    ![](../images/2023-11-03-15-17-48.png)
    2. Clique em **Ação**.
    ![](../images/2023-11-03-15-18-24.png)
    3. Clique em **Solicitar Aprovação**.
    ![](../images/2023-11-03-15-19-26.png)
     **Adicione o registro que o gerente está aprovando.**
    4. Clique no **Selecionador de Dados**.
    ![](../images/2023-11-03-15-24-17.png)
    5. Selecione **Gatilho – Registro Criado**.
    6. Selecione **Registro de Caso de Teletrabalho**.
    ![](../images/2023-11-03-15-26-13.png)

:::info
* Você notou que o **Campo de Aprovação** e o **Campo de Diário** foram preenchidos automaticamente?
![](../images/2023-11-03-15-27-11.png)
* Isso ocorre porque esses campos já existiam na tabela **Tarefa** da qual estendemos o **Caso de Teletrabalho**.<br/>
* **LEMBRE-SE:** 
  * Se você estiver rastreando qualquer tipo de trabalho (chamados, solicitações, etc.), é _sempre_ uma boa ideia estender da **Tarefa**, a menos que você tenha um bom motivo para não fazê-lo.
:::
9. **Configure as Regras para quando este registro for aprovado.**
    1. Clique no menu suspenso '-Escolher regra de aprovação'.
    ![](../images/2023-11-03-15-30-36.png)
    2. Escolha **Qualquer um aprova**.
    ![](../images/2023-11-03-15-31-08.png)
    **Em seguida, você precisa especificar para quem a aprovação será enviada.**
    3. Clique no **Selecionador de Dados** para procurar dados no registro 'Telework Case' que acionou este fluxo.
    ![](../images/2023-11-03-15-32-25.png)
    4. Clique em **Gatilho - Registro Criado**.
    ![](../images/2023-11-03-15-34-04.png)
    5. Clique na seta ao lado para acessar a lista de campos no registro 'Telework Case'.
    ![](../images/2023-11-03-15-35-36.png)
    6. Role para baixo para localizar o campo **Opened by** e clique na seta ao lado.
    ![](../images/2023-11-03-15-38-38.png)
    7. Role para baixo para localizar o campo **Manager** e clique nele.
    ![](../images/2023-11-03-15-39-59.png)
    8. Clique em <span className="button-purple">Concluído</span> para finalizar a configuração da Ação 'Solicitar Aprovação'.
    ![](../images/2023-11-03-15-40-53.png)

:::info
Ir de Registro para Registro para encontrar um campo específico no ServiceNow é chamado de "Dot-Walking".
:::

10. **Adicione a Lógica do Fluxo para _Se o gerente aprovar_...**
    1. Sob a Ação 'Solicitar Aprovação', **clique** em **Adicionar uma Ação, Lógica de Fluxo ou Subfluxo**.
    ![](../images/2023-11-03-15-43-03.png)
    2. Clique em **Lógica de Fluxo**.
    3. Clique em **Se**.
    ![](../images/2023-11-03-15-44-43.png)
    4. No campo **Rótulo da Condição** digite "Gerente aprova".
    ![](../images/2023-11-03-15-46-19.png)
    5. Clique no **Selecionador de Dados** ao lado de 'Condição 1'.
    6. Clique em **1 - Solicitar Aprovação**.
    7. Clique em **Estado da Aprovação**.
    ![](../images/2023-11-03-15-50-27.png)
    8. Clique no menu suspenso 'Selecionar uma opção'.
    9. Clique em 'Aprovado'.
    ![](../images/2023-11-03-15-52-22.png)
    10. Clique em <span className="button-purple">Concluído</span>.

:::info
Adicionar o **Rótulo da Condição** como 'Gerente Aprova' foi como adicionar um comentário ao nosso código.
![](../images/2023-11-03-15-54-42.png)
Isso facilitará qualquer solução de problemas mais tarde, pois você pode ver o que a Lógica de Fluxo faz sem abri-la.
:::

Em seguida, se o gerente aprovar, uma tarefa deve ser enviada ao IT para configurar o acesso VPN para a pessoa.

11. **Adicione a Ação Criar Tarefa.**
    1. Sob _Se o Gerente Aprovar_, clique em ⊕ ao lado de 'então'.
    ![](../images/2023-11-03-15-57-31.png)
    2. Selecione **Ação** > **ServiceNow Core** > **Criar Tarefa**.
    ![](../images/2023-11-03-16-00-05.png)
    3. Para Tabela, selecione "Ticket".
    ![](../images/2023-11-03-16-00-37.png)
    4. Clique em **Adicionar um valor de campo**.
    ![](../images/2023-11-03-16-02-17.png)
    5. Clique em 'Selecionar um campo'.
    6. Pesquise 'Parent' no menu suspenso e clique nele.
    ![](../images/2023-11-03-16-01-41.png)
    **Defina o campo 'Parent' no novo registro 'Ticket' para ser o registro 'Telework Case' que acionou este Fluxo.**
    7. Clique no **Selecionador de Dados**.
    8. Selecione **Gatilho - Registro criado** > **Registro do Caso de Teletrabalho**.
    ![](../images/2023-11-03-16-11-38.png)
    **Resultado:**
    ![](../images/2023-11-03-16-12-37.png)
    9. Clique em **+ Adicionar valor de campo** e adicione dois outros campos:
    ![](../images/2023-11-03-16-13-08.png)

    |Nome do Campo            | Valor do Campo
    |-------------------------| --------------
    |**Descrição curta**      | Acesso VPN |
    |**Atribuído a**          | Administrador do sistema (_Normalmente você não especificaria um usuário aqui, mas isso facilitará o laboratório._)|

    10. Se os Valores dos Campos estiverem como abaixo, clique em <span className="button-purple">Concluído</span>.
    ![](../images/2023-11-08-20-28-32.png)
    11. Clique no botão **Adicionar Anotação** à direita da Ação **Criar Tarefa**.
    ![](../images/2023-11-03-16-16-53.png)
    12. Digite `Solicitar Acesso VPN` e pressione ENTER.
    ![](../images/2023-11-03-16-18-10.png)

:::info
Adicionar Anotações torna o Fluxo mais fácil de ler.
![](../images/2023-11-03-16-19-03.png)
:::

**Envie um e-mail para o usuário 'Opened by' e informe-o de que sua solicitação de Teletrabalho foi aprovada.**

12. **Adicione e configure a Ação 'Enviar Email'.**
    1. Clique em ⊕ sob **Criar Tarefa**.
    ![](../images/2023-11-03-16-20-48.png)
    2. Selecione **Ação** > **ServiceNow Core** > **Enviar Email**.
    ![](../images/2023-11-03-16-22-41.png)
    3. Clique no botão **Adicionar Anotação**.
    4. Digite `Notificar Aberto Por` no campo e pressione ENTER.
    ![](../images/2023-11-03-16-24-39.png)
    **Os e-mails precisam estar associados a um registro alvo para rastreamento.**
    5. Clique no **Selecionador de Dados** ao lado do **Registro Alvo**.
    6. Selecione **Gatilho - Registro criado** > **Registro do Caso de Teletrabalho**.
    ![](../images/2023-11-03-16-27-03.png)
    7. Clique no **Selecionador de Dados** ao lado do campo **Para**.
    8. Clique em **Gatilho - Registro criado**.
    9. Clique na seta ao lado de 'Registro do Caso de Teletrabalho'.
    10. Clique na seta ao lado de 'Opened by'.
    11. Clique em 'Email'.
    ![](../images/2023-11-03-16-28-53.png)

    12. Para o **Assunto**, insira:<br/><br/>
    `Sua solicitação de Teletrabalho foi aprovada`<br/><br/>

    ### Defina o Corpo do e-mail.

    13. No campo **Corpo**, digite `Caro ` _(Certifique-se de incluir o espaço extra no final)_.
    ![](../images/2023-11-03-16-33-21.png)
    14. Clique no **Selecionador de Dados** à direita do campo **Corpo**.
    ![](../images/2023-11-03-16-35-02.png)
    15. Navegue até e clique no campo **Gatilho - Registro Criado** >> **Registro do Caso de Teletrabalho** >> **Opened by** >> **Nome**.
    ![](../images/2023-11-03-16-36-32.png)

    :::info
    Se você soltar o Dados Pill antes da palavra 'Caro ', você pode arrastá-lo para o local correto.

    ![](../images/2023-11-08_14-55-21.gif)

    :::
    
    **RESULTADO:**
    ![](../images/2023-11-03-16-37-31.png)

    16. No campo **Corpo**, pressione Enter para mover o cursor para a próxima linha.
    17. Digite `Sua solicitação para ` _(Certifique-se de incluir o espaço extra no final)_.
    ![](../images/2023-11-03-16-39-09.png)
    18. Clique no **Selecionador de Dados** à direita do campo **Corpo**.
    19. Navegue até e clique no campo **Gatilho - Registro Criado** >> **Registro do Caso de Teletrabalho** >> **Arranjo** >> **Código**.
    ![](../images/2023-11-03-16-41-26.png)
    20. Digite `<espaço>está aprovado.` após o dados pill. _(Certifique-se de incluir um espaço extra antes das palavras)_.
    ![](../images/2023-11-03-16-42-53.png)
    21. Clique em <span className="button-purple">Concluído</span>.

13. Seu fluxo deve se parecer com isso:
![](../images/2023-11-03-16-45-01.png)

14. Clique na visualização em Diagrama para visualizar o fluxo como um Diagrama.
![](../images/2023-11-03-16-47-57.png)

15. No canto superior direito da tela, clique em <span className="button-purple">Salvar</span>.

16. Clique em <span className="button-purple">Ativar</span> à esquerda do botão Salvar. Isso torna o Fluxo 'ativo' no aplicativo.

17. Na caixa de Confirmação, clique no botão <span className="button-purple">Ativar</span>.

18. Feche a guia do Fluxo no App Engine Studio.
![](../images/2023-11-03-16-51-42.png)

## Recapitulação do Exercício

Você criou um Fluxo que cuida da gestão de tarefas e comunicações entre vários departamentos.

Em seguida, você irá testar o Fluxo para vê-lo em ação.
